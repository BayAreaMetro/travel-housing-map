<html>
	<head>
		<title>MTC SCS: Travel Time</title>
		<style type="text/css">
			@import url(../style/screen.css);

			#travel-time {
				height: 500px !important;
			}

		</style>
		<script type="text/javascript" src="js/LAB.min.js"></script>
		<script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script>
		<script type="text/javascript" defer="defer">

			$LAB
			.setOptions({
				AlwaysPreserveOrder: true
			})
			.script("js/jquery-1.5.min.js")
			.script("js/polymaps.min.js")
			.script("js/htmapl.js")
			.script("js/utils.js")
			.script("js/autofill.js")
			.script("js/geocode.js")
			.script("/data/blk2taz/convert.js")
			.script("js/travel-time.js").wait(initialize);

			function tazID(feature) {
				return feature.properties["TAZ1454"];
			}

			function initialize() {
				var po = org.polymaps;

				var form = $("form").first(),
						selected = form.find("input[name=taz]").val(),
						map = $("#travel-time").data("map");

				$("#selected-taz").text(selected);

				var layer = $("#taz-shapes").data("layer");
				var style = po.stylist()
					.attr("id", function(feature) { return "taz" + tazID(feature); })
					.attr("fill", function(feature) {
						return tazID(feature) == selected ? "yellow" : "blue";
					})
					.attr("fill-opacity", ".8");
				layer.on("show", style);
				layer.on("load", style);
				console.log(layer);
			}

		</script>
	</head>
	<body>
		<div id="page">

			<h1><a href="/">Move</a> / <a href="./">Maps</a> / Travel Time</h1>

			<h2>You've selected:
				<acronym title="Transportation Analysis Zone">TAZ</acronym> #<span id="selected-taz">???</span>
			</h2>

			<form class="autofill" action="time.html" method="GET">
				<input type="hidden" name="taz"/>

				<div class="map drag" id="travel-time" data-zoomRange="7,16">
					<input type="hidden" name="center" value="37.7639,-122.4130"/>
					<input type="hidden" name="zoom" value="9"/>
					<div class="layer" data-type="image"
						data-url="http://a.acetate.geoiq.com/tiles/acetate-base/{Z}/{X}/{Y}.png"></div>
					<div class="layer" id="taz-shapes" data-type="geoJson"
						data-scale="fixed" data-zoom="10" data-url="/data/taz1454.json"></div>
					<div class="layer" id="acetate-roads" data-type="image"
						data-url="http://a.acetate.geoiq.com/tiles/acetate-roads/{Z}/{X}/{Y}.png"></div>
					<div class="layer" id="acetate-labels" data-type="image"
						data-url="http://a.acetate.geoiq.com/tiles/acetate-labels/{Z}/{X}/{Y}.png"></div>
					<!--
					<div class="layer" data-type="image"
						data-url="http://c.tile.cloudmade.com/1a1b06b230af4efdbb989ea99e9841af/998/256/{Z}/{X}/{Y}.png"></div>
					-->
					<div class="crosshairs"></div>
					<div class="controls">
						<label>Zoom:</label> <a class="zoom-in" href="#location-map"><img alt="in" src="../style/images/zoom-plus.png"/></a>
						<a class="zoom-out" href="#location-map"><img alt="out" src="../style/images/zoom-minus.png"/></a>
					</div>

					<div id="geocoder">
						<p>
							<label for="address">Find an address:</label>
							<input accesskey="a" type="search" results="5" name="address" value="" data-default="enter an address"/>
							<input type="submit" name="geocode" value="Search"/>
						</p>
						<p class="status error">Unable to geocode: <tt>foo</tt></p>
					</div>

			</form>

		</div>
	</body>
</html>
